require=function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module){"use strict";module.exports={isChrome:function(){if("undefined"!==typeof window){var userAgent=navigator.userAgent.toLowerCase();if(userAgent.match(/chrome\/([\d\.]+)/)){return!0}}return!1},randomCode:function(len){var d,e,b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",c="";for(d=0;len>d;d+=1){e=Math.random()*b.length;e=Math.floor(e);c+=b.charAt(e)}return c}}},{}],2:[function(require,module){"use strict";module.exports={mainnetUrl:"https://pay.nebulas.io/api/mainnet/pay",testnetUrl:"https://pay.nebulas.io/api/pay"}},{}],3:[function(require,module){"use strict";var callbackMap={};window.addEventListener("message",function(resp){console.log("nebpay: received resp.data: "+JSON.stringify(resp.data));if("content"!==resp.data.src)return;var key=resp.data.serialNumber,callback=callbackMap[key];if("function"===typeof callback){callback(resp.data.resp)}});module.exports=function(params){if(params.listener){callbackMap[params.serialNumber]=params.listener}params.listener=void 0;window.postMessage({src:"nebPay",logo:"nebulas",params:params},"*")}},{}],4:[function(require,module){"use strict";var request=function(obj){return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest;xhr.open(obj.method||"GET",obj.url);if(obj.headers){Object.keys(obj.headers).forEach(function(key){xhr.setRequestHeader(key,obj.headers[key])})}xhr.onload=function(){if(200<=xhr.status&&300>xhr.status){resolve(xhr.response)}else{reject(xhr.statusText)}};xhr.onerror=function(){return reject(xhr.statusText)};xhr.send(obj.body)})};module.exports={get:function(url,body){return request({url:url,method:"GET",body:body})},post:function(url,body){return request({url:url,method:"POST",body:body})},request:request}},{}],5:[function(require,module){"use strict";var BigNumber=require("bignumber.js"),Utils=require("./Utils"),QRCode=require("./qrcode"),openExtension=require("./extensionUtils.js"),Pay=function(appKey,appSecret){this.appKey=appKey;this.appSecret=appSecret};Pay.prototype={submit:function(currency,to,value,payload,options){options.serialNumber=Utils.randomCode(32);value=value||"0";var amount=new BigNumber(value).times("1000000000000000000"),params={serialNumber:options.serialNumber,goods:options.goods,pay:{currency:currency,to:to,value:amount.toString(10),payload:payload},callback:options.callback,listener:options.listener,nrc20:options.nrc20};openExtension(params);openApp(params,options);return options.serialNumber}};function openApp(params,options){var appParams={category:"jump",des:"confirmTransfer",pageParams:params},url="openapp.NASnano://virtual?params="+JSON.stringify(appParams);window.location.href=url;if(options.qrcode.showQRCode){showQRCode(JSON.stringify(appParams),options)}}function showQRCode(params,options){QRCode.showQRCode(params,options.qrcode.container)}module.exports=Pay},{"./Utils":1,"./extensionUtils.js":3,"./qrcode":6,"bignumber.js":7}],6:[function(require,module){"use strict";var QRCode=require("qrcode"),addCssRule=function(){var sheet=function(){var style=document.createElement("style");style.type="text/css";document.head.appendChild(style);return style.sheet}();return function(selector,rules,index){index=index||0;sheet.insertRule(selector+"{"+rules+"}",index)}}(),createDeaultQRContainer=function(){var canvas=document.createElement("canvas");canvas.className="qrcode";addCssRule(".qrcode","box-shadow: 2px 2px 12px lightgray;");var qrcontainer=document.createElement("div");qrcontainer.className="qrcode-container";var style="text-align: center;    background-color: #fff0;    border-radius: 20px;    width: 300px;    height: 300px;    position: absolute;    left: 50%;    top: 50%;    transform: translate(-50%,-50%);";addCssRule(".qrcode-container",style);qrcontainer.appendChild(canvas);var background=document.createElement("div");background.className="qrcode-background";style="position:absolute;\tleft:0;\ttop:0;\tz-index:100;\theight:100%;\twidth:100%;\tbackground-color: rgba(0, 0, 0, 0.4);";addCssRule(".qrcode-background",style);background.appendChild(qrcontainer);var body=document.getElementsByTagName("body");body[0].appendChild(background);background.onclick=function(){body[0].removeChild(background)};return canvas};module.exports={showQRCode:function(content,container){if("undefined"===typeof window){return}if("undefined"===typeof container){container=createDeaultQRContainer()}QRCode.toCanvas(container,content,function(error){if(error){console.error(error)}})}}},{qrcode:12}],7:[function(require,module){(function(globalObj){"use strict";var BigNumber,isNumeric=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,mathceil=Math.ceil,mathfloor=Math.floor,notBool=" not a boolean or binary digit",roundingMode="rounding mode",tooManyDigits="number type has more than 15 significant digits",ALPHABET="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",BASE=1e14,LOG_BASE=14,MAX_SAFE_INTEGER=9007199254740991,POWS_TEN=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],SQRT_BASE=1e7,MAX=1E9;function constructorFactory(config){var div,parseNumeric,id=0,P=BigNumber.prototype,ONE=new BigNumber(1),DECIMAL_PLACES=20,ROUNDING_MODE=4,TO_EXP_NEG=-7,TO_EXP_POS=21,MIN_EXP=-1e7,MAX_EXP=1e7,ERRORS=!0,isValidInt=intValidatorWithErrors,CRYPTO=!1,MODULO_MODE=1,POW_PRECISION=0,FORMAT={decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:"\xA0",fractionGroupSize:0};function BigNumber(n,b){var c,e,i,num,len,str,x=this;if(!(x instanceof BigNumber)){return new BigNumber(n,b)}if(null==b||!isValidInt(b,2,64,id,"base")){if(n instanceof BigNumber){x.s=n.s;x.e=n.e;x.c=(n=n.c)?n.slice():n;id=0;return}if((num="number"==typeof n)&&0==0*n){x.s=0>1/n?(n=-n,-1):1;if(n===~~n){for(e=0,i=n;10<=i;i/=10,e++);x.e=e;x.c=[n];id=0;return}str=n+""}else{if(!isNumeric.test(str=n+""))return parseNumeric(x,str,num);x.s=45===str.charCodeAt(0)?(str=str.slice(1),-1):1}}else{b=0|b;str=n+"";if(10==b){x=new BigNumber(n instanceof BigNumber?n:str);return round(x,DECIMAL_PLACES+x.e+1,ROUNDING_MODE)}if((num="number"==typeof n)&&0!=0*n||!new RegExp("^-?"+(c="["+ALPHABET.slice(0,b)+"]+")+"(?:\\."+c+")?$",37>b?"i":"").test(str)){return parseNumeric(x,str,num,b)}if(num){x.s=0>1/n?(str=str.slice(1),-1):1;if(ERRORS&&15<str.replace(/^0\.0*|\./,"").length){raise(id,tooManyDigits,n)}num=!1}else{x.s=45===str.charCodeAt(0)?(str=str.slice(1),-1):1}str=convertBase(str,10,b,x.s)}if(-1<(e=str.indexOf(".")))str=str.replace(".","");if(0<(i=str.search(/e/i))){if(0>e)e=i;e+=+str.slice(i+1);str=str.substring(0,i)}else if(0>e){e=str.length}for(i=0;48===str.charCodeAt(i);i++);for(len=str.length;48===str.charCodeAt(--len););str=str.slice(i,len+1);if(str){len=str.length;if(num&&ERRORS&&15<len&&(n>MAX_SAFE_INTEGER||n!==mathfloor(n))){raise(id,tooManyDigits,x.s*n)}e=e-i-1;if(e>MAX_EXP){x.c=x.e=null}else if(e<MIN_EXP){x.c=[x.e=0]}else{x.e=e;x.c=[];i=(e+1)%LOG_BASE;if(0>e)i+=LOG_BASE;if(i<len){if(i)x.c.push(+str.slice(0,i));for(len-=LOG_BASE;i<len;){x.c.push(+str.slice(i,i+=LOG_BASE))}str=str.slice(i);i=LOG_BASE-str.length}else{i-=len}for(;i--;str+="0");x.c.push(+str)}}else{x.c=[x.e=0]}id=0}BigNumber.another=constructorFactory;BigNumber.ROUND_UP=0;BigNumber.ROUND_DOWN=1;BigNumber.ROUND_CEIL=2;BigNumber.ROUND_FLOOR=3;BigNumber.ROUND_HALF_UP=4;BigNumber.ROUND_HALF_DOWN=5;BigNumber.ROUND_HALF_EVEN=6;BigNumber.ROUND_HALF_CEIL=7;BigNumber.ROUND_HALF_FLOOR=8;BigNumber.EUCLID=9;BigNumber.config=BigNumber.set=function(){var v,p,i=0,r={},a=arguments,o=a[0],has=o&&"object"==typeof o?function(){if(o.hasOwnProperty(p))return null!=(v=o[p])}:function(){if(a.length>i)return null!=(v=a[i++])};if(has(p="DECIMAL_PLACES")&&isValidInt(v,0,MAX,2,p)){DECIMAL_PLACES=0|v}r[p]=DECIMAL_PLACES;if(has(p="ROUNDING_MODE")&&isValidInt(v,0,8,2,p)){ROUNDING_MODE=0|v}r[p]=ROUNDING_MODE;if(has(p="EXPONENTIAL_AT")){if(isArray(v)){if(isValidInt(v[0],-MAX,0,2,p)&&isValidInt(v[1],0,MAX,2,p)){TO_EXP_NEG=0|v[0];TO_EXP_POS=0|v[1]}}else if(isValidInt(v,-MAX,MAX,2,p)){TO_EXP_NEG=-(TO_EXP_POS=0|(0>v?-v:v))}}r[p]=[TO_EXP_NEG,TO_EXP_POS];if(has(p="RANGE")){if(isArray(v)){if(isValidInt(v[0],-MAX,-1,2,p)&&isValidInt(v[1],1,MAX,2,p)){MIN_EXP=0|v[0];MAX_EXP=0|v[1]}}else if(isValidInt(v,-MAX,MAX,2,p)){if(0|v)MIN_EXP=-(MAX_EXP=0|(0>v?-v:v));else if(ERRORS)raise(2,p+" cannot be zero",v)}}r[p]=[MIN_EXP,MAX_EXP];if(has(p="ERRORS")){if(v===!!v||1===v||0===v){id=0;isValidInt=(ERRORS=!!v)?intValidatorWithErrors:intValidatorNoErrors}else if(ERRORS){raise(2,p+notBool,v)}}r[p]=ERRORS;if(has(p="CRYPTO")){if(!0===v||!1===v||1===v||0===v){if(v){v="undefined"==typeof crypto;if(!v&&crypto&&(crypto.getRandomValues||crypto.randomBytes)){CRYPTO=!0}else if(ERRORS){raise(2,"crypto unavailable",v?void 0:crypto)}else{CRYPTO=!1}}else{CRYPTO=!1}}else if(ERRORS){raise(2,p+notBool,v)}}r[p]=CRYPTO;if(has(p="MODULO_MODE")&&isValidInt(v,0,9,2,p)){MODULO_MODE=0|v}r[p]=MODULO_MODE;if(has(p="POW_PRECISION")&&isValidInt(v,0,MAX,2,p)){POW_PRECISION=0|v}r[p]=POW_PRECISION;if(has(p="FORMAT")){if("object"==typeof v){FORMAT=v}else if(ERRORS){raise(2,p+" not an object",v)}}r[p]=FORMAT;return r};BigNumber.max=function(){return maxOrMin(arguments,P.lt)};BigNumber.min=function(){return maxOrMin(arguments,P.gt)};BigNumber.random=function(){var pow2_53=9007199254740992,random53bitInt=2097151&Math.random()*pow2_53?function(){return mathfloor(Math.random()*pow2_53)}:function(){return 8388608*(0|1073741824*Math.random())+(0|8388608*Math.random())};return function(dp){var a,b,e,k,v,i=0,c=[],rand=new BigNumber(ONE);dp=null==dp||!isValidInt(dp,0,MAX,14)?DECIMAL_PLACES:0|dp;k=mathceil(dp/LOG_BASE);if(CRYPTO){if(crypto.getRandomValues){a=crypto.getRandomValues(new Uint32Array(k*=2));for(;i<k;){v=131072*a[i]+(a[i+1]>>>11);if(9e15<=v){b=crypto.getRandomValues(new Uint32Array(2));a[i]=b[0];a[i+1]=b[1]}else{c.push(v%1e14);i+=2}}i=k/2}else if(crypto.randomBytes){a=crypto.randomBytes(k*=7);for(;i<k;){v=281474976710656*(31&a[i])+1099511627776*a[i+1]+4294967296*a[i+2]+16777216*a[i+3]+(a[i+4]<<16)+(a[i+5]<<8)+a[i+6];if(9e15<=v){crypto.randomBytes(7).copy(a,i)}else{c.push(v%1e14);i+=7}}i=k/7}else{CRYPTO=!1;if(ERRORS)raise(14,"crypto unavailable",crypto)}}if(!CRYPTO){for(;i<k;){v=random53bitInt();if(9e15>v)c[i++]=v%1e14}}k=c[--i];dp%=LOG_BASE;if(k&&dp){v=POWS_TEN[LOG_BASE-dp];c[i]=mathfloor(k/v)*v}for(;0===c[i];c.pop(),i--);if(0>i){c=[e=0]}else{for(e=-1;0===c[0];c.splice(0,1),e-=LOG_BASE);for(i=1,v=c[0];10<=v;v/=10,i++);if(i<LOG_BASE)e-=LOG_BASE-i}rand.e=e;rand.c=c;return rand}}();function convertBase(str,baseOut,baseIn,sign){var d,e,k,r,x,xc,y,i=str.indexOf("."),dp=DECIMAL_PLACES,rm=ROUNDING_MODE;if(37>baseIn)str=str.toLowerCase();if(0<=i){k=POW_PRECISION;POW_PRECISION=0;str=str.replace(".","");y=new BigNumber(baseIn);x=y.pow(str.length-i);POW_PRECISION=k;y.c=toBaseOut(toFixedPoint(coeffToString(x.c),x.e),10,baseOut);y.e=y.c.length}xc=toBaseOut(str,baseIn,baseOut);e=k=xc.length;for(;0==xc[--k];xc.pop());if(!xc[0])return"0";if(0>i){--e}else{x.c=xc;x.e=e;x.s=sign;x=div(x,y,dp,rm,baseOut);xc=x.c;r=x.r;e=x.e}d=e+dp+1;i=xc[d];k=baseOut/2;r=r||0>d||null!=xc[d+1];r=4>rm?(null!=i||r)&&(0==rm||rm==(0>x.s?3:2)):i>k||i==k&&(4==rm||r||6==rm&&1&xc[d-1]||rm==(0>x.s?8:7));if(1>d||!xc[0]){str=r?toFixedPoint("1",-dp):"0"}else{xc.length=d;if(r){for(--baseOut;++xc[--d]>baseOut;){xc[d]=0;if(!d){++e;xc=[1].concat(xc)}}}for(k=xc.length;!xc[--k];);for(i=0,str="";i<=k;str+=ALPHABET.charAt(xc[i++]));str=toFixedPoint(str,e)}return str}div=function(){function multiply(x,k,base){var m,temp,xlo,xhi,carry=0,i=x.length,klo=k%SQRT_BASE,khi=0|k/SQRT_BASE;for(x=x.slice();i--;){xlo=x[i]%SQRT_BASE;xhi=0|x[i]/SQRT_BASE;m=khi*xlo+xhi*klo;temp=klo*xlo+m%SQRT_BASE*SQRT_BASE+carry;carry=(0|temp/base)+(0|m/SQRT_BASE)+khi*xhi;x[i]=temp%base}if(carry)x=[carry].concat(x);return x}function compare(a,b,aL,bL){var i,cmp;if(aL!=bL){cmp=aL>bL?1:-1}else{for(i=cmp=0;i<aL;i++){if(a[i]!=b[i]){cmp=a[i]>b[i]?1:-1;break}}}return cmp}function subtract(a,b,aL,base){var i=0;for(;aL--;){a[aL]-=i;i=a[aL]<b[aL]?1:0;a[aL]=i*base+a[aL]-b[aL]}for(;!a[0]&&1<a.length;a.splice(0,1));}return function(x,y,dp,rm,base){var cmp,e,i,more,n,prod,prodL,q,qc,rem,remL,rem0,xi,xL,yc0,yL,yz,s=x.s==y.s?1:-1,xc=x.c,yc=y.c;if(!xc||!xc[0]||!yc||!yc[0]){return new BigNumber(!x.s||!y.s||(xc?yc&&xc[0]==yc[0]:!yc)?NaN:xc&&0==xc[0]||!yc?0*s:s/0)}q=new BigNumber(s);qc=q.c=[];e=x.e-y.e;s=dp+e+1;if(!base){base=BASE;e=bitFloor(x.e/LOG_BASE)-bitFloor(y.e/LOG_BASE);s=0|s/LOG_BASE}for(i=0;yc[i]==(xc[i]||0);i++);if(yc[i]>(xc[i]||0))e--;if(0>s){qc.push(1);more=!0}else{xL=xc.length;yL=yc.length;i=0;s+=2;n=mathfloor(base/(yc[0]+1));if(1<n){yc=multiply(yc,n,base);xc=multiply(xc,n,base);yL=yc.length;xL=xc.length}xi=yL;rem=xc.slice(0,yL);remL=rem.length;for(;remL<yL;rem[remL++]=0);yz=yc.slice();yz=[0].concat(yz);yc0=yc[0];if(yc[1]>=base/2)yc0++;do{n=0;cmp=compare(yc,rem,yL,remL);if(0>cmp){rem0=rem[0];if(yL!=remL)rem0=rem0*base+(rem[1]||0);n=mathfloor(rem0/yc0);if(1<n){if(n>=base)n=base-1;prod=multiply(yc,n,base);prodL=prod.length;remL=rem.length;while(1==compare(prod,rem,prodL,remL)){n--;subtract(prod,yL<prodL?yz:yc,prodL,base);prodL=prod.length;cmp=1}}else{if(0==n){cmp=n=1}prod=yc.slice();prodL=prod.length}if(prodL<remL)prod=[0].concat(prod);subtract(rem,prod,remL,base);remL=rem.length;if(-1==cmp){while(1>compare(yc,rem,yL,remL)){n++;subtract(rem,yL<remL?yz:yc,remL,base);remL=rem.length}}}else if(0===cmp){n++;rem=[0]}qc[i++]=n;if(rem[0]){rem[remL++]=xc[xi]||0}else{rem=[xc[xi]];remL=1}}while((xi++<xL||null!=rem[0])&&s--);more=null!=rem[0];if(!qc[0])qc.splice(0,1)}if(base==BASE){for(i=1,s=qc[0];10<=s;s/=10,i++);round(q,dp+(q.e=i+e*LOG_BASE-1)+1,rm,more)}else{q.e=e;q.r=+more}return q}}();function format(n,i,rm,caller){var c0,e,ne,len,str;rm=null!=rm&&isValidInt(rm,0,8,caller,roundingMode)?0|rm:ROUNDING_MODE;if(!n.c)return n.toString();c0=n.c[0];ne=n.e;if(null==i){str=coeffToString(n.c);str=19==caller||24==caller&&ne<=TO_EXP_NEG?toExponential(str,ne):toFixedPoint(str,ne)}else{n=round(new BigNumber(n),i,rm);e=n.e;str=coeffToString(n.c);len=str.length;if(19==caller||24==caller&&(i<=e||e<=TO_EXP_NEG)){for(;len<i;str+="0",len++);str=toExponential(str,e)}else{i-=ne;str=toFixedPoint(str,e);if(e+1>len){if(0<--i)for(str+=".";i--;str+="0");}else{i+=e-len;if(0<i){if(e+1==len)str+=".";for(;i--;str+="0");}}}}return 0>n.s&&c0?"-"+str:str}function maxOrMin(args,method){var m,n,i=0;if(isArray(args[0]))args=args[0];m=new BigNumber(args[0]);for(;++i<args.length;){n=new BigNumber(args[i]);if(!n.s){m=n;break}else if(method.call(m,n)){m=n}}return m}function intValidatorWithErrors(n,min,max,caller,name){if(n<min||n>max||n!=truncate(n)){raise(caller,(name||"decimal places")+(n<min||n>max?" out of range":" not an integer"),n)}return!0}function normalise(n,c,e){var i=1,j=c.length;for(;!c[--j];c.pop());for(j=c[0];10<=j;j/=10,i++);if((e=i+e*LOG_BASE-1)>MAX_EXP){n.c=n.e=null}else if(e<MIN_EXP){n.c=[n.e=0]}else{n.e=e;n.c=c}return n}parseNumeric=function(){var basePrefix=/^(-?)0([xbo])(?=\w[\w.]*$)/i,dotAfter=/^([^.]+)\.$/,dotBefore=/^\.([^.]+)$/,isInfinityOrNaN=/^-?(Infinity|NaN)$/,whitespaceOrPlus=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(x,str,num,b){var base,s=num?str:str.replace(whitespaceOrPlus,"");if(isInfinityOrNaN.test(s)){x.s=isNaN(s)?null:0>s?-1:1}else{if(!num){s=s.replace(basePrefix,function(m,p1,p2){base="x"==(p2=p2.toLowerCase())?16:"b"==p2?2:8;return!b||b==base?p1:m});if(b){base=b;s=s.replace(dotAfter,"$1").replace(dotBefore,"0.$1")}if(str!=s)return new BigNumber(s,base)}if(ERRORS)raise(id,"not a"+(b?" base "+b:"")+" number",str);x.s=null}x.c=x.e=null;id=0}}();function raise(caller,msg,val){var error=new Error(["new BigNumber","cmp","config","div","divToInt","eq","gt","gte","lt","lte","minus","mod","plus","precision","random","round","shift","times","toDigits","toExponential","toFixed","toFormat","toFraction","pow","toPrecision","toString","BigNumber"][caller]+"() "+msg+": "+val);error.name="BigNumber Error";id=0;throw error}function round(x,sd,rm,r){var d,i,j,k,n,ni,rd,xc=x.c,pows10=POWS_TEN;if(xc){out:{for(d=1,k=xc[0];10<=k;k/=10,d++);i=sd-d;if(0>i){i+=LOG_BASE;j=sd;n=xc[ni=0];rd=0|n/pows10[d-j-1]%10}else{ni=mathceil((i+1)/LOG_BASE);if(ni>=xc.length){if(r){for(;xc.length<=ni;xc.push(0));n=rd=0;d=1;i%=LOG_BASE;j=i-LOG_BASE+1}else{break out}}else{n=k=xc[ni];for(d=1;10<=k;k/=10,d++);i%=LOG_BASE;j=i-LOG_BASE+d;rd=0>j?0:0|n/pows10[d-j-1]%10}}r=r||0>sd||null!=xc[ni+1]||(0>j?n:n%pows10[d-j-1]);r=4>rm?(rd||r)&&(0==rm||rm==(0>x.s?3:2)):5<rd||5==rd&&(4==rm||r||6==rm&&1&(0<i?0<j?n/pows10[d-j]:0:xc[ni-1])%10||rm==(0>x.s?8:7));if(1>sd||!xc[0]){xc.length=0;if(r){sd-=x.e+1;xc[0]=pows10[(LOG_BASE-sd%LOG_BASE)%LOG_BASE];x.e=-sd||0}else{xc[0]=x.e=0}return x}if(0==i){xc.length=ni;k=1;ni--}else{xc.length=ni+1;k=pows10[LOG_BASE-i];xc[ni]=0<j?mathfloor(n/pows10[d-j]%pows10[j])*k:0}if(r){for(;;){if(0==ni){for(i=1,j=xc[0];10<=j;j/=10,i++);j=xc[0]+=k;for(k=1;10<=j;j/=10,k++);if(i!=k){x.e++;if(xc[0]==BASE)xc[0]=1}break}else{xc[ni]+=k;if(xc[ni]!=BASE)break;xc[ni--]=0;k=1}}}for(i=xc.length;0===xc[--i];xc.pop());}if(x.e>MAX_EXP){x.c=x.e=null}else if(x.e<MIN_EXP){x.c=[x.e=0]}}return x}P.absoluteValue=P.abs=function(){var x=new BigNumber(this);if(0>x.s)x.s=1;return x};P.ceil=function(){return round(new BigNumber(this),this.e+1,2)};P.comparedTo=P.cmp=function(y,b){id=1;return compare(this,new BigNumber(y,b))};P.decimalPlaces=P.dp=function(){var n,v,c=this.c;if(!c)return null;n=((v=c.length-1)-bitFloor(this.e/LOG_BASE))*LOG_BASE;if(v=c[v])for(;0==v%10;v/=10,n--);if(0>n)n=0;return n};P.dividedBy=P.div=function(y,b){id=3;return div(this,new BigNumber(y,b),DECIMAL_PLACES,ROUNDING_MODE)};P.dividedToIntegerBy=P.divToInt=function(y,b){id=4;return div(this,new BigNumber(y,b),0,1)};P.equals=P.eq=function(y,b){id=5;return 0===compare(this,new BigNumber(y,b))};P.floor=function(){return round(new BigNumber(this),this.e+1,3)};P.greaterThan=P.gt=function(y,b){id=6;return 0<compare(this,new BigNumber(y,b))};P.greaterThanOrEqualTo=P.gte=function(y,b){id=7;return 1===(b=compare(this,new BigNumber(y,b)))||0===b};P.isFinite=function(){return!!this.c};P.isInteger=P.isInt=function(){return!!this.c&&bitFloor(this.e/LOG_BASE)>this.c.length-2};P.isNaN=function(){return!this.s};P.isNegative=P.isNeg=function(){return 0>this.s};P.isZero=function(){return!!this.c&&0==this.c[0]};P.lessThan=P.lt=function(y,b){id=8;return 0>compare(this,new BigNumber(y,b))};P.lessThanOrEqualTo=P.lte=function(y,b){id=9;return-1===(b=compare(this,new BigNumber(y,b)))||0===b};P.minus=P.sub=function(y,b){var i,j,t,xLTy,x=this,a=x.s;id=10;y=new BigNumber(y,b);b=y.s;if(!a||!b)return new BigNumber(NaN);if(a!=b){y.s=-b;return x.plus(y)}var xe=x.e/LOG_BASE,ye=y.e/LOG_BASE,xc=x.c,yc=y.c;if(!xe||!ye){if(!xc||!yc)return xc?(y.s=-b,y):new BigNumber(yc?x:NaN);if(!xc[0]||!yc[0]){return yc[0]?(y.s=-b,y):new BigNumber(xc[0]?x:3==ROUNDING_MODE?-0:0)}}xe=bitFloor(xe);ye=bitFloor(ye);xc=xc.slice();if(a=xe-ye){if(xLTy=0>a){a=-a;t=xc}else{ye=xe;t=yc}t.reverse();for(b=a;b--;t.push(0));t.reverse()}else{j=(xLTy=(a=xc.length)<(b=yc.length))?a:b;for(a=b=0;b<j;b++){if(xc[b]!=yc[b]){xLTy=xc[b]<yc[b];break}}}if(xLTy)t=xc,xc=yc,yc=t,y.s=-y.s;b=(j=yc.length)-(i=xc.length);if(0<b)for(;b--;xc[i++]=0);b=BASE-1;for(;j>a;){if(xc[--j]<yc[j]){for(i=j;i&&!xc[--i];xc[i]=b);--xc[i];xc[j]+=BASE}xc[j]-=yc[j]}for(;0==xc[0];xc.splice(0,1),--ye);if(!xc[0]){y.s=3==ROUNDING_MODE?-1:1;y.c=[y.e=0];return y}return normalise(y,xc,ye)};P.modulo=P.mod=function(y,b){var q,s,x=this;id=11;y=new BigNumber(y,b);if(!x.c||!y.s||y.c&&!y.c[0]){return new BigNumber(NaN)}else if(!y.c||x.c&&!x.c[0]){return new BigNumber(x)}if(9==MODULO_MODE){s=y.s;y.s=1;q=div(x,y,0,3);y.s=s;q.s*=s}else{q=div(x,y,0,MODULO_MODE)}return x.minus(q.times(y))};P.negated=P.neg=function(){var x=new BigNumber(this);x.s=-x.s||null;return x};P.plus=P.add=function(y,b){var t,x=this,a=x.s;id=12;y=new BigNumber(y,b);b=y.s;if(!a||!b)return new BigNumber(NaN);if(a!=b){y.s=-b;return x.minus(y)}var xe=x.e/LOG_BASE,ye=y.e/LOG_BASE,xc=x.c,yc=y.c;if(!xe||!ye){if(!xc||!yc)return new BigNumber(a/0);if(!xc[0]||!yc[0])return yc[0]?y:new BigNumber(xc[0]?x:0*a)}xe=bitFloor(xe);ye=bitFloor(ye);xc=xc.slice();if(a=xe-ye){if(0<a){ye=xe;t=yc}else{a=-a;t=xc}t.reverse();for(;a--;t.push(0));t.reverse()}a=xc.length;b=yc.length;if(0>a-b)t=yc,yc=xc,xc=t,b=a;for(a=0;b;){a=0|(xc[--b]=xc[b]+yc[b]+a)/BASE;xc[b]=BASE===xc[b]?0:xc[b]%BASE}if(a){xc=[a].concat(xc);++ye}return normalise(y,xc,ye)};P.precision=P.sd=function(z){var n,v,x=this,c=x.c;if(null!=z&&z!==!!z&&1!==z&&0!==z){if(ERRORS)raise(13,"argument"+notBool,z);if(z!=!!z)z=null}if(!c)return null;v=c.length-1;n=v*LOG_BASE+1;if(v=c[v]){for(;0==v%10;v/=10,n--);for(v=c[0];10<=v;v/=10,n++);}if(z&&x.e+1>n)n=x.e+1;return n};P.round=function(dp,rm){var n=new BigNumber(this);if(null==dp||isValidInt(dp,0,MAX,15)){round(n,~~dp+this.e+1,null==rm||!isValidInt(rm,0,8,15,roundingMode)?ROUNDING_MODE:0|rm)}return n};P.shift=function(k){var n=this;return isValidInt(k,-MAX_SAFE_INTEGER,MAX_SAFE_INTEGER,16,"argument")?n.times("1e"+truncate(k)):new BigNumber(n.c&&n.c[0]&&(k<-MAX_SAFE_INTEGER||k>MAX_SAFE_INTEGER)?n.s*(0>k?0:1/0):n)};P.squareRoot=P.sqrt=function(){var _Mathsqrt=Math.sqrt,m,n,r,rep,t,x=this,c=x.c,s=x.s,e=x.e,dp=DECIMAL_PLACES+4,half=new BigNumber("0.5");if(1!==s||!c||!c[0]){return new BigNumber(!s||0>s&&(!c||c[0])?NaN:c?x:1/0)}s=_Mathsqrt(+x);if(0==s||s==1/0){n=coeffToString(c);if(0==(n.length+e)%2)n+="0";s=_Mathsqrt(n);e=bitFloor((e+1)/2)-(0>e||e%2);if(s==1/0){n="1e"+e}else{n=s.toExponential();n=n.slice(0,n.indexOf("e")+1)+e}r=new BigNumber(n)}else{r=new BigNumber(s+"")}if(r.c[0]){e=r.e;s=e+dp;if(3>s)s=0;for(;;){t=r;r=half.times(t.plus(div(x,t,dp,1)));if(coeffToString(t.c).slice(0,s)===(n=coeffToString(r.c)).slice(0,s)){if(r.e<e)--s;n=n.slice(s-3,s+1);if("9999"==n||!rep&&"4999"==n){if(!rep){round(t,t.e+DECIMAL_PLACES+2,0);if(t.times(t).eq(x)){r=t;break}}dp+=4;s+=4;rep=1}else{if(!+n||!+n.slice(1)&&"5"==n.charAt(0)){round(r,r.e+DECIMAL_PLACES+2,1);m=!r.times(r).eq(x)}break}}}}return round(r,r.e+DECIMAL_PLACES+1,ROUNDING_MODE,m)};P.times=P.mul=function(y,b){var c,e,i,j,k,m,xcL,xlo,xhi,ycL,ylo,yhi,zc,base,sqrtBase,x=this,xc=x.c,yc=(id=17,y=new BigNumber(y,b)).c;if(!xc||!yc||!xc[0]||!yc[0]){if(!x.s||!y.s||xc&&!xc[0]&&!yc||yc&&!yc[0]&&!xc){y.c=y.e=y.s=null}else{y.s*=x.s;if(!xc||!yc){y.c=y.e=null}else{y.c=[0];y.e=0}}return y}e=bitFloor(x.e/LOG_BASE)+bitFloor(y.e/LOG_BASE);y.s*=x.s;xcL=xc.length;ycL=yc.length;if(xcL<ycL)zc=xc,xc=yc,yc=zc,i=xcL,xcL=ycL,ycL=i;for(i=xcL+ycL,zc=[];i--;zc.push(0));base=BASE;sqrtBase=SQRT_BASE;for(i=ycL;0<=--i;){c=0;ylo=yc[i]%sqrtBase;yhi=0|yc[i]/sqrtBase;for(k=xcL,j=i+k;j>i;){xlo=xc[--k]%sqrtBase;xhi=0|xc[k]/sqrtBase;m=yhi*xlo+xhi*ylo;xlo=ylo*xlo+m%sqrtBase*sqrtBase+zc[j]+c;c=(0|xlo/base)+(0|m/sqrtBase)+yhi*xhi;zc[j--]=xlo%base}zc[j]=c}if(c){++e}else{zc.splice(0,1)}return normalise(y,zc,e)};P.toDigits=function(sd,rm){var n=new BigNumber(this);sd=null==sd||!isValidInt(sd,1,MAX,18,"precision")?null:0|sd;rm=null==rm||!isValidInt(rm,0,8,18,roundingMode)?ROUNDING_MODE:0|rm;return sd?round(n,sd,rm):n};P.toExponential=function(dp,rm){return format(this,null!=dp&&isValidInt(dp,0,MAX,19)?~~dp+1:null,rm,19)};P.toFixed=function(dp,rm){return format(this,null!=dp&&isValidInt(dp,0,MAX,20)?~~dp+this.e+1:null,rm,20)};P.toFormat=function(dp,rm){var str=format(this,null!=dp&&isValidInt(dp,0,MAX,21)?~~dp+this.e+1:null,rm,21);if(this.c){var i,arr=str.split("."),g1=+FORMAT.groupSize,g2=+FORMAT.secondaryGroupSize,groupSeparator=FORMAT.groupSeparator,intPart=arr[0],fractionPart=arr[1],isNeg=0>this.s,intDigits=isNeg?intPart.slice(1):intPart,len=intDigits.length;if(g2)i=g1,g1=g2,g2=i,len-=i;if(0<g1&&0<len){i=len%g1||g1;intPart=intDigits.substr(0,i);for(;i<len;i+=g1){intPart+=groupSeparator+intDigits.substr(i,g1)}if(0<g2)intPart+=groupSeparator+intDigits.slice(i);if(isNeg)intPart="-"+intPart}str=fractionPart?intPart+FORMAT.decimalSeparator+((g2=+FORMAT.fractionGroupSize)?fractionPart.replace(new RegExp("\\d{"+g2+"}\\B","g"),"$&"+FORMAT.fractionGroupSeparator):fractionPart):intPart}return str};P.toFraction=function(md){var arr,d0,d2,e,exp,n,n0,q,s,k=ERRORS,x=this,xc=x.c,d=new BigNumber(ONE),n1=d0=new BigNumber(ONE),d1=n0=new BigNumber(ONE);if(null!=md){ERRORS=!1;n=new BigNumber(md);ERRORS=k;if(!(k=n.isInt())||n.lt(ONE)){if(ERRORS){raise(22,"max denominator "+(k?"out of range":"not an integer"),md)}md=!k&&n.c&&round(n,n.e+1,1).gte(ONE)?n:null}}if(!xc)return x.toString();s=coeffToString(xc);e=d.e=s.length-x.e-1;d.c[0]=POWS_TEN[0>(exp=e%LOG_BASE)?LOG_BASE+exp:exp];md=!md||0<n.cmp(d)?0<e?d:n1:n;exp=MAX_EXP;MAX_EXP=1/0;n=new BigNumber(s);n0.c[0]=0;for(;;){q=div(n,d,0,1);d2=d0.plus(q.times(d1));if(1==d2.cmp(md))break;d0=d1;d1=d2;n1=n0.plus(q.times(d2=n1));n0=d2;d=n.minus(q.times(d2=d));n=d2}d2=div(md.minus(d0),d1,0,1);n0=n0.plus(d2.times(n1));d0=d0.plus(d2.times(d1));n0.s=n1.s=x.s;e*=2;arr=1>div(n1,d1,e,ROUNDING_MODE).minus(x).abs().cmp(div(n0,d0,e,ROUNDING_MODE).minus(x).abs())?[n1.toString(),d1.toString()]:[n0.toString(),d0.toString()];MAX_EXP=exp;return arr};P.toNumber=function(){return+this};P.toPower=P.pow=function(n,m){var k,y,z,i=mathfloor(0>n?-n:+n),x=this;if(null!=m){id=23;m=new BigNumber(m)}if(!isValidInt(n,-MAX_SAFE_INTEGER,MAX_SAFE_INTEGER,23,"exponent")&&(!isFinite(n)||i>MAX_SAFE_INTEGER&&(n/=0)||parseFloat(n)!=n&&!(n=NaN))||0==n){k=Math.pow(+x,n);return new BigNumber(m?k%m:k)}if(m){if(1<n&&x.gt(ONE)&&x.isInt()&&m.gt(ONE)&&m.isInt()){x=x.mod(m)}else{z=m;m=null}}else if(POW_PRECISION){k=mathceil(POW_PRECISION/LOG_BASE+2)}y=new BigNumber(ONE);for(;;){if(i%2){y=y.times(x);if(!y.c)break;if(k){if(y.c.length>k)y.c.length=k}else if(m){y=y.mod(m)}}i=mathfloor(i/2);if(!i)break;x=x.times(x);if(k){if(x.c&&x.c.length>k)x.c.length=k}else if(m){x=x.mod(m)}}if(m)return y;if(0>n)y=ONE.div(y);return z?y.mod(z):k?round(y,POW_PRECISION,ROUNDING_MODE):y};P.toPrecision=function(sd,rm){return format(this,null!=sd&&isValidInt(sd,1,MAX,24,"precision")?0|sd:null,rm,24)};P.toString=function(b){var str,n=this,s=n.s,e=n.e;if(null===e){if(s){str="Infinity";if(0>s)str="-"+str}else{str="NaN"}}else{str=coeffToString(n.c);if(null==b||!isValidInt(b,2,64,25,"base")){str=e<=TO_EXP_NEG||e>=TO_EXP_POS?toExponential(str,e):toFixedPoint(str,e)}else{str=convertBase(toFixedPoint(str,e),0|b,10,s)}if(0>s&&n.c[0])str="-"+str}return str};P.truncated=P.trunc=function(){return round(new BigNumber(this),this.e+1,1)};P.valueOf=P.toJSON=function(){var str,n=this,e=n.e;if(null===e)return n.toString();str=coeffToString(n.c);str=e<=TO_EXP_NEG||e>=TO_EXP_POS?toExponential(str,e):toFixedPoint(str,e);return 0>n.s?"-"+str:str};P.isBigNumber=!0;if(null!=config)BigNumber.config(config);return BigNumber}function bitFloor(n){var i=0|n;return 0<n||n===i?i:i-1}function coeffToString(a){var s,z,i=1,j=a.length,r=a[0]+"";for(;i<j;){s=a[i++]+"";z=LOG_BASE-s.length;for(;z--;s="0"+s);r+=s}for(j=r.length;48===r.charCodeAt(--j););return r.slice(0,j+1||1)}function compare(x,y){var a,b,xc=x.c,yc=y.c,i=x.s,j=y.s,k=x.e,l=y.e;if(!i||!j)return null;a=xc&&!xc[0];b=yc&&!yc[0];if(a||b)return a?b?0:-j:i;if(i!=j)return i;a=0>i;b=k==l;if(!xc||!yc)return b?0:!xc^a?1:-1;if(!b)return k>l^a?1:-1;j=(k=xc.length)<(l=yc.length)?k:l;for(i=0;i<j;i++)if(xc[i]!=yc[i])return xc[i]>yc[i]^a?1:-1;return k==l?0:k>l^a?1:-1}function intValidatorNoErrors(n,min,max){return(n=truncate(n))>=min&&n<=max}function isArray(obj){return"[object Array]"==Object.prototype.toString.call(obj)}function toBaseOut(str,baseIn,baseOut){var j,arr=[0],arrL,i=0,len=str.length;for(;i<len;){for(arrL=arr.length;arrL--;arr[arrL]*=baseIn);arr[j=0]+=ALPHABET.indexOf(str.charAt(i++));for(;j<arr.length;j++){if(arr[j]>baseOut-1){if(null==arr[j+1])arr[j+1]=0;arr[j+1]+=0|arr[j]/baseOut;arr[j]%=baseOut}}}return arr.reverse()}function toExponential(str,e){return(1<str.length?str.charAt(0)+"."+str.slice(1):str)+(0>e?"e":"e+")+e}function toFixedPoint(str,e){var len,z;if(0>e){for(z="0.";++e;z+="0");str=z+str}else{len=str.length;if(++e>len){for(z="0",e-=len;--e;z+="0");str+=z}else if(e<len){str=str.slice(0,e)+"."+str.slice(e)}}return str}function truncate(n){n=parseFloat(n);return 0>n?mathceil(n):mathfloor(n)}BigNumber=constructorFactory();BigNumber["default"]=BigNumber.BigNumber=BigNumber;if("function"==typeof define&&define.amd){define(function(){return BigNumber})}else if("undefined"!=typeof module&&module.exports){module.exports=BigNumber}else{if(!globalObj)globalObj="undefined"!=typeof self?self:Function("return this")();globalObj.BigNumber=BigNumber}})(this)},{}],8:[function(require,module){"use strict";var G=require("window-or-global");module.exports=function(){return"function"===typeof G.Promise&&"function"===typeof G.Promise.prototype.then}},{"window-or-global":38}],9:[function(require,module){"use strict";var dijkstra={single_source_shortest_paths:function(graph,s,d){var predecessors={},costs={};costs[s]=0;var open=dijkstra.PriorityQueue.make();open.push(s,0);var closest,u,v,cost_of_s_to_u,adjacent_nodes,cost_of_e,cost_of_s_to_u_plus_cost_of_e,cost_of_s_to_v,first_visit;while(!open.empty()){closest=open.pop();u=closest.value;cost_of_s_to_u=closest.cost;adjacent_nodes=graph[u]||{};for(v in adjacent_nodes){if(adjacent_nodes.hasOwnProperty(v)){cost_of_e=adjacent_nodes[v];cost_of_s_to_u_plus_cost_of_e=cost_of_s_to_u+cost_of_e;cost_of_s_to_v=costs[v];first_visit="undefined"===typeof costs[v];if(first_visit||cost_of_s_to_v>cost_of_s_to_u_plus_cost_of_e){costs[v]=cost_of_s_to_u_plus_cost_of_e;open.push(v,cost_of_s_to_u_plus_cost_of_e);predecessors[v]=u}}}}if("undefined"!==typeof d&&"undefined"===typeof costs[d]){var msg=["Could not find a path from ",s," to ",d,"."].join("");throw new Error(msg)}return predecessors},extract_shortest_path_from_predecessor_list:function(predecessors,d){var nodes=[],u=d;while(u){nodes.push(u);predecessors[u];u=predecessors[u]}nodes.reverse();return nodes},find_path:function(graph,s,d){var predecessors=dijkstra.single_source_shortest_paths(graph,s,d);return dijkstra.extract_shortest_path_from_predecessor_list(predecessors,d)},PriorityQueue:{make:function(opts){var T=dijkstra.PriorityQueue,t={},key;opts=opts||{};for(key in T){if(T.hasOwnProperty(key)){t[key]=T[key]}}t.queue=[];t.sorter=opts.sorter||T.default_sorter;return t},default_sorter:function(a,b){return a.cost-b.cost},push:function(value,cost){this.queue.push({value:value,cost:cost});this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};if("undefined"!==typeof module){module.exports=dijkstra}},{}],10:[function(require,module){"use strict";var hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,isArray=function(arr){if("function"===typeof Array.isArray){return Array.isArray(arr)}return"[object Array]"===toStr.call(arr)},isPlainObject=function(obj){if(!obj||"[object Object]"!==toStr.call(obj)){return!1}var hasOwnConstructor=hasOwn.call(obj,"constructor"),hasIsPrototypeOf=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!hasOwnConstructor&&!hasIsPrototypeOf){return!1}for(var key in obj){}return"undefined"===typeof key||hasOwn.call(obj,key)};module.exports=function extend(){var options,name,src,copy,copyIsArray,clone,target=arguments[0],i=1,length=arguments.length,deep=!1;if("boolean"===typeof target){deep=target;target=arguments[1]||{};i=2}if(null==target||"object"!==typeof target&&"function"!==typeof target){target={}}for(;i<length;++i){options=arguments[i];if(null!=options){for(name in options){src=target[name];copy=options[name];if(target!==copy){if(deep&&copy&&(isPlainObject(copy)||(copyIsArray=isArray(copy)))){if(copyIsArray){copyIsArray=!1;clone=src&&isArray(src)?src:[]}else{clone=src&&isPlainObject(src)?src:{}}target[name]=extend(deep,clone,copy)}else if("undefined"!==typeof copy){target[name]=copy}}}}}return target}},{}],11:[function(require,module){var toString={}.toString;module.exports=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)}},{}],12:[function(require,module,exports){var canPromise=require("can-promise"),QRCode=require("./core/qrcode"),CanvasRenderer=require("./renderer/canvas"),SvgRenderer=require("./renderer/svg-tag.js");function renderCanvas(renderFunc,canvas,text,opts,cb){var args=[].slice.call(arguments,1),argsNum=args.length,isLastArgCb="function"===typeof args[argsNum-1];if(!isLastArgCb&&!canPromise()){throw new Error("Callback required as last argument")}if(isLastArgCb){if(2>argsNum){throw new Error("Too few arguments provided")}if(2===argsNum){cb=text;text=canvas;canvas=opts=void 0}else if(3===argsNum){if(canvas.getContext&&"undefined"===typeof cb){cb=opts;opts=void 0}else{cb=opts;opts=text;text=canvas;canvas=void 0}}}else{if(1>argsNum){throw new Error("Too few arguments provided")}if(1===argsNum){text=canvas;canvas=opts=void 0}else if(2===argsNum&&!canvas.getContext){opts=text;text=canvas;canvas=void 0}return new Promise(function(resolve,reject){try{var data=QRCode.create(text,opts);resolve(renderFunc(data,canvas,opts))}catch(e){reject(e)}})}try{var data=QRCode.create(text,opts);cb(null,renderFunc(data,canvas,opts))}catch(e){cb(e)}}exports.create=QRCode.create;exports.toCanvas=renderCanvas.bind(null,CanvasRenderer.render);exports.toDataURL=renderCanvas.bind(null,CanvasRenderer.renderToDataURL);exports.toString=renderCanvas.bind(null,function(data,_,opts){return SvgRenderer.render(data,opts)})},{"./core/qrcode":28,"./renderer/canvas":34,"./renderer/svg-tag.js":35,"can-promise":8}],13:[function(require,module,exports){var getSymbolSize=require("./utils").getSymbolSize;exports.getRowColCoords=function(version){if(1===version)return[];for(var posCount=Math.floor(version/7)+2,size=getSymbolSize(version),intervals=145===size?26:2*Math.ceil((size-13)/(2*posCount-2)),positions=[size-7],i=1;i<posCount-1;i++){positions[i]=positions[i-1]-intervals}positions.push(6);return positions.reverse()};exports.getPositions=function(version){for(var coords=[],pos=exports.getRowColCoords(version),posLength=pos.length,i=0;i<posLength;i++){for(var j=0;j<posLength;j++){if(0===i&&0===j||0===i&&j===posLength-1||i===posLength-1&&0===j){continue}coords.push([pos[i],pos[j]])}}return coords}},{"./utils":32}],14:[function(require,module){var Mode=require("./mode"),ALPHA_NUM_CHARS=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function AlphanumericData(data){this.mode=Mode.ALPHANUMERIC;this.data=data}AlphanumericData.getBitsLength=function(length){return 11*Math.floor(length/2)+6*(length%2)};AlphanumericData.prototype.getLength=function(){return this.data.length};AlphanumericData.prototype.getBitsLength=function(){return AlphanumericData.getBitsLength(this.data.length)};AlphanumericData.prototype.write=function(bitBuffer){var i;for(i=0;i+2<=this.data.length;i+=2){var value=45*ALPHA_NUM_CHARS.indexOf(this.data[i]);value+=ALPHA_NUM_CHARS.indexOf(this.data[i+1]);bitBuffer.put(value,11)}if(this.data.length%2){bitBuffer.put(ALPHA_NUM_CHARS.indexOf(this.data[i]),6)}};module.exports=AlphanumericData},{"./mode":25}],15:[function(require,module){var _Mathfloor=Math.floor;function BitBuffer(){this.buffer=[];this.length=0}BitBuffer.prototype={get:function(index){var bufIndex=_Mathfloor(index/8);return 1===(1&this.buffer[bufIndex]>>>7-index%8)},put:function(num,length){for(var i=0;i<length;i++){this.putBit(1===(1&num>>>length-i-1))}},getLengthInBits:function(){return this.length},putBit:function(bit){var bufIndex=_Mathfloor(this.length/8);if(this.buffer.length<=bufIndex){this.buffer.push(0)}if(bit){this.buffer[bufIndex]|=128>>>this.length%8}this.length++}};module.exports=BitBuffer},{}],16:[function(require,module){var Buffer=require("../utils/buffer");function BitMatrix(size){if(!size||1>size){throw new Error("BitMatrix size must be defined and greater than 0")}this.size=size;this.data=new Buffer(size*size);this.data.fill(0);this.reservedBit=new Buffer(size*size);this.reservedBit.fill(0)}BitMatrix.prototype.set=function(row,col,value,reserved){var index=row*this.size+col;this.data[index]=value;if(reserved)this.reservedBit[index]=!0};BitMatrix.prototype.get=function(row,col){return this.data[row*this.size+col]};BitMatrix.prototype.xor=function(row,col,value){this.data[row*this.size+col]^=value};BitMatrix.prototype.isReserved=function(row,col){return this.reservedBit[row*this.size+col]};module.exports=BitMatrix},{"../utils/buffer":37}],17:[function(require,module){var Buffer=require("../utils/buffer"),Mode=require("./mode");function ByteData(data){this.mode=Mode.BYTE;this.data=new Buffer(data)}ByteData.getBitsLength=function(length){return 8*length};ByteData.prototype.getLength=function(){return this.data.length};ByteData.prototype.getBitsLength=function(){return ByteData.getBitsLength(this.data.length)};ByteData.prototype.write=function(bitBuffer){for(var i=0,l=this.data.length;i<l;i++){bitBuffer.put(this.data[i],8)}};module.exports=ByteData},{"../utils/buffer":37,"./mode":25}],18:[function(require,module,exports){var ECLevel=require("./error-correction-level"),EC_BLOCKS_TABLE=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],EC_CODEWORDS_TABLE=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];exports.getBlocksCount=function(version,errorCorrectionLevel){switch(errorCorrectionLevel){case ECLevel.L:return EC_BLOCKS_TABLE[4*(version-1)+0];case ECLevel.M:return EC_BLOCKS_TABLE[4*(version-1)+1];case ECLevel.Q:return EC_BLOCKS_TABLE[4*(version-1)+2];case ECLevel.H:return EC_BLOCKS_TABLE[4*(version-1)+3];default:}};exports.getTotalCodewordsCount=function(version,errorCorrectionLevel){switch(errorCorrectionLevel){case ECLevel.L:return EC_CODEWORDS_TABLE[4*(version-1)+0];case ECLevel.M:return EC_CODEWORDS_TABLE[4*(version-1)+1];case ECLevel.Q:return EC_CODEWORDS_TABLE[4*(version-1)+2];case ECLevel.H:return EC_CODEWORDS_TABLE[4*(version-1)+3];default:}}},{"./error-correction-level":19}],19:[function(require,module,exports){exports.L={bit:1};exports.M={bit:0};exports.Q={bit:3};exports.H={bit:2};function fromString(string){if("string"!==typeof string){throw new Error("Param is not a string")}var lcStr=string.toLowerCase();switch(lcStr){case"l":case"low":return exports.L;case"m":case"medium":return exports.M;case"q":case"quartile":return exports.Q;case"h":case"high":return exports.H;default:throw new Error("Unknown EC Level: "+string);}}exports.isValid=function(level){return level&&"undefined"!==typeof level.bit&&0<=level.bit&&4>level.bit};exports.from=function(value,defaultValue){if(exports.isValid(value)){return value}try{return fromString(value)}catch(e){return defaultValue}}},{}],20:[function(require,module,exports){var getSymbolSize=require("./utils").getSymbolSize,FINDER_PATTERN_SIZE=7;exports.getPositions=function(version){var size=getSymbolSize(version);return[[0,0],[size-FINDER_PATTERN_SIZE,0],[0,size-FINDER_PATTERN_SIZE]]}},{"./utils":32}],21:[function(require,module,exports){var Utils=require("./utils"),G15=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0,G15_BCH=Utils.getBCHDigit(G15);exports.getEncodedBits=function(errorCorrectionLevel,mask){var data=errorCorrectionLevel.bit<<3|mask,d=data<<10;while(0<=Utils.getBCHDigit(d)-G15_BCH){d^=G15<<Utils.getBCHDigit(d)-G15_BCH}return(data<<10|d)^(1<<14|1<<12|1<<10|1<<4|1<<1)}},{"./utils":32}],22:[function(require,module,exports){var Buffer=require("../utils/buffer"),EXP_TABLE=new Buffer(512),LOG_TABLE=new Buffer(256);(function(){for(var x=1,i=0;255>i;i++){EXP_TABLE[i]=x;LOG_TABLE[x]=i;x<<=1;if(256&x){x^=285}}for(i=255;512>i;i++){EXP_TABLE[i]=EXP_TABLE[i-255]}})();exports.log=function(n){if(1>n)throw new Error("log("+n+")");return LOG_TABLE[n]};exports.exp=function(n){return EXP_TABLE[n]};exports.mul=function(x,y){if(0===x||0===y)return 0;return EXP_TABLE[LOG_TABLE[x]+LOG_TABLE[y]]}},{"../utils/buffer":37}],23:[function(require,module){var Mode=require("./mode"),Utils=require("./utils");function KanjiData(data){this.mode=Mode.KANJI;this.data=data}KanjiData.getBitsLength=function(length){return 13*length};KanjiData.prototype.getLength=function(){return this.data.length};KanjiData.prototype.getBitsLength=function(){return KanjiData.getBitsLength(this.data.length)};KanjiData.prototype.write=function(bitBuffer){var i;for(i=0;i<this.data.length;i++){var value=Utils.toSJIS(this.data[i]);if(33088<=value&&40956>=value){value-=33088}else if(57408<=value&&60351>=value){value-=49472}else{throw new Error("Invalid SJIS character: "+this.data[i]+"\n"+"Make sure your charset is UTF-8")}value=192*(255&value>>>8)+(255&value);bitBuffer.put(value,13)}};module.exports=KanjiData},{"./mode":25,"./utils":32}],24:[function(require,module,exports){var _Mathfloor2=Math.floor;exports.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var PenaltyScores={N1:3,N2:3,N3:40,N4:10};exports.isValid=function(mask){return mask&&""!==mask&&!isNaN(mask)&&0<=mask&&7>=mask};exports.from=function(value){return exports.isValid(value)?parseInt(value,10):void 0};exports.getPenaltyN1=function(data){for(var size=data.size,points=0,sameCountCol=0,sameCountRow=0,lastCol=null,lastRow=null,row=0;row<size;row++){sameCountCol=sameCountRow=0;lastCol=lastRow=null;for(var col=0,module;col<size;col++){module=data.get(row,col);if(module===lastCol){sameCountCol++}else{if(5<=sameCountCol)points+=PenaltyScores.N1+(sameCountCol-5);lastCol=module;sameCountCol=1}module=data.get(col,row);if(module===lastRow){sameCountRow++}else{if(5<=sameCountRow)points+=PenaltyScores.N1+(sameCountRow-5);lastRow=module;sameCountRow=1}}if(5<=sameCountCol)points+=PenaltyScores.N1+(sameCountCol-5);if(5<=sameCountRow)points+=PenaltyScores.N1+(sameCountRow-5)}return points};exports.getPenaltyN2=function(data){for(var size=data.size,points=0,row=0;row<size-1;row++){for(var col=0,last;col<size-1;col++){last=data.get(row,col)+data.get(row,col+1)+data.get(row+1,col)+data.get(row+1,col+1);if(4===last||0===last)points++}}return points*PenaltyScores.N2};exports.getPenaltyN3=function(data){for(var size=data.size,points=0,bitsCol=0,bitsRow=0,row=0;row<size;row++){bitsCol=bitsRow=0;for(var col=0;col<size;col++){bitsCol=2047&bitsCol<<1|data.get(row,col);if(10<=col&&(1488===bitsCol||93===bitsCol))points++;bitsRow=2047&bitsRow<<1|data.get(col,row);if(10<=col&&(1488===bitsRow||93===bitsRow))points++}}return points*PenaltyScores.N3};exports.getPenaltyN4=function(data){for(var darkCount=0,modulesCount=data.data.length,i=0;i<modulesCount;i++)darkCount+=data.data[i];var k=Math.abs(Math.ceil(100*darkCount/modulesCount/5)-10);return k*PenaltyScores.N4};function getMaskAt(maskPattern,i,j){switch(maskPattern){case exports.Patterns.PATTERN000:return 0===(i+j)%2;case exports.Patterns.PATTERN001:return 0===i%2;case exports.Patterns.PATTERN010:return 0===j%3;case exports.Patterns.PATTERN011:return 0===(i+j)%3;case exports.Patterns.PATTERN100:return 0===(_Mathfloor2(i/2)+_Mathfloor2(j/3))%2;case exports.Patterns.PATTERN101:return 0===i*j%2+i*j%3;case exports.Patterns.PATTERN110:return 0===(i*j%2+i*j%3)%2;case exports.Patterns.PATTERN111:return 0===(i*j%3+(i+j)%2)%2;default:throw new Error("bad maskPattern:"+maskPattern);}}exports.applyMask=function(pattern,data){for(var size=data.size,col=0;col<size;col++){for(var row=0;row<size;row++){if(data.isReserved(row,col))continue;data.xor(row,col,getMaskAt(pattern,row,col))}}};exports.getBestMask=function(data,setupFormatFunc){for(var numPatterns=Object.keys(exports.Patterns).length,bestPattern=0,lowerPenalty=1/0,p=0;p<numPatterns;p++){setupFormatFunc(p);exports.applyMask(p,data);var penalty=exports.getPenaltyN1(data)+exports.getPenaltyN2(data)+exports.getPenaltyN3(data)+exports.getPenaltyN4(data);exports.applyMask(p,data);if(penalty<lowerPenalty){lowerPenalty=penalty;bestPattern=p}}return bestPattern}},{}],25:[function(require,module,exports){var Version=require("./version"),Regex=require("./regex");exports.NUMERIC={id:"Numeric",bit:1<<0,ccBits:[10,12,14]};exports.ALPHANUMERIC={id:"Alphanumeric",bit:1<<1,ccBits:[9,11,13]};exports.BYTE={id:"Byte",bit:1<<2,ccBits:[8,16,16]};exports.KANJI={id:"Kanji",bit:1<<3,ccBits:[8,10,12]};exports.MIXED={bit:-1};exports.getCharCountIndicator=function(mode,version){if(!mode.ccBits)throw new Error("Invalid mode: "+mode);if(!Version.isValid(version)){throw new Error("Invalid version: "+version)}if(1<=version&&10>version)return mode.ccBits[0];else if(27>version)return mode.ccBits[1];return mode.ccBits[2]};exports.getBestModeForData=function(dataStr){if(Regex.testNumeric(dataStr))return exports.NUMERIC;else if(Regex.testAlphanumeric(dataStr))return exports.ALPHANUMERIC;else if(Regex.testKanji(dataStr))return exports.KANJI;else return exports.BYTE};exports.toString=function(mode){if(mode&&mode.id)return mode.id;throw new Error("Invalid mode")};exports.isValid=function(mode){return mode&&mode.bit&&mode.ccBits};function fromString(string){if("string"!==typeof string){throw new Error("Param is not a string")}var lcStr=string.toLowerCase();switch(lcStr){case"numeric":return exports.NUMERIC;case"alphanumeric":return exports.ALPHANUMERIC;case"kanji":return exports.KANJI;case"byte":return exports.BYTE;default:throw new Error("Unknown mode: "+string);}}exports.from=function(value,defaultValue){if(exports.isValid(value)){return value}try{return fromString(value)}catch(e){return defaultValue}}},{"./regex":30,"./version":33}],26:[function(require,module){var Mode=require("./mode");function NumericData(data){this.mode=Mode.NUMERIC;this.data=data.toString()}NumericData.getBitsLength=function(length){return 10*Math.floor(length/3)+(length%3?3*(length%3)+1:0)};NumericData.prototype.getLength=function(){return this.data.length};NumericData.prototype.getBitsLength=function(){return NumericData.getBitsLength(this.data.length)};NumericData.prototype.write=function(bitBuffer){var i,group,value;for(i=0;i+3<=this.data.length;i+=3){group=this.data.substr(i,3);value=parseInt(group,10);bitBuffer.put(value,10)}var remainingNum=this.data.length-i;if(0<remainingNum){group=this.data.substr(i);value=parseInt(group,10);bitBuffer.put(value,3*remainingNum+1)}};module.exports=NumericData},{"./mode":25}],27:[function(require,module,exports){var Buffer=require("../utils/buffer"),GF=require("./galois-field");exports.mul=function(p1,p2){var coeff=new Buffer(p1.length+p2.length-1);coeff.fill(0);for(var i=0;i<p1.length;i++){for(var j=0;j<p2.length;j++){coeff[i+j]^=GF.mul(p1[i],p2[j])}}return coeff};exports.mod=function(divident,divisor){var result=new Buffer(divident);while(0<=result.length-divisor.length){for(var coeff=result[0],i=0;i<divisor.length;i++){result[i]^=GF.mul(divisor[i],coeff)}var offset=0;while(offset<result.length&&0===result[offset])offset++;result=result.slice(offset)}return result};exports.generateECPolynomial=function(degree){for(var poly=new Buffer([1]),i=0;i<degree;i++){poly=exports.mul(poly,[1,GF.exp(i)])}return poly}},{"../utils/buffer":37,"./galois-field":22}],28:[function(require,module,exports){var _Mathfloor3=Math.floor,Buffer=require("../utils/buffer"),Utils=require("./utils"),ECLevel=require("./error-correction-level"),BitBuffer=require("./bit-buffer"),BitMatrix=require("./bit-matrix"),AlignmentPattern=require("./alignment-pattern"),FinderPattern=require("./finder-pattern"),MaskPattern=require("./mask-pattern"),ECCode=require("./error-correction-code"),ReedSolomonEncoder=require("./reed-solomon-encoder"),Version=require("./version"),FormatInfo=require("./format-info"),Mode=require("./mode"),Segments=require("./segments"),isArray=require("isarray");function setupFinderPattern(matrix,version){for(var size=matrix.size,pos=FinderPattern.getPositions(version),i=0;i<pos.length;i++){for(var row=pos[i][0],col=pos[i][1],r=-1;7>=r;r++){if(-1>=row+r||size<=row+r)continue;for(var c=-1;7>=c;c++){if(-1>=col+c||size<=col+c)continue;if(0<=r&&6>=r&&(0===c||6===c)||0<=c&&6>=c&&(0===r||6===r)||2<=r&&4>=r&&2<=c&&4>=c){matrix.set(row+r,col+c,!0,!0)}else{matrix.set(row+r,col+c,!1,!0)}}}}}function setupTimingPattern(matrix){for(var size=matrix.size,r=8,value;r<size-8;r++){value=0===r%2;matrix.set(r,6,value,!0);matrix.set(6,r,value,!0)}}function setupAlignmentPattern(matrix,version){for(var pos=AlignmentPattern.getPositions(version),i=0;i<pos.length;i++){for(var row=pos[i][0],col=pos[i][1],r=-2;2>=r;r++){for(var c=-2;2>=c;c++){if(-2===r||2===r||-2===c||2===c||0===r&&0===c){matrix.set(row+r,col+c,!0,!0)}else{matrix.set(row+r,col+c,!1,!0)}}}}}function setupVersionInfo(matrix,version){for(var size=matrix.size,bits=Version.getEncodedBits(version),row,col,mod,i=0;18>i;i++){row=_Mathfloor3(i/3);col=i%3+size-8-3;mod=1===(1&bits>>i);matrix.set(row,col,mod,!0);matrix.set(col,row,mod,!0)}}function setupFormatInfo(matrix,errorCorrectionLevel,maskPattern){var size=matrix.size,bits=FormatInfo.getEncodedBits(errorCorrectionLevel,maskPattern),i,mod;for(i=0;15>i;i++){mod=1===(1&bits>>i);if(6>i){matrix.set(i,8,mod,!0)}else if(8>i){matrix.set(i+1,8,mod,!0)}else{matrix.set(size-15+i,8,mod,!0)}if(8>i){matrix.set(8,size-i-1,mod,!0)}else if(9>i){matrix.set(8,15-i-1+1,mod,!0)}else{matrix.set(8,15-i-1,mod,!0)}}matrix.set(size-8,8,1,!0)}function setupData(matrix,data){for(var size=matrix.size,inc=-1,row=size-1,bitIndex=7,byteIndex=0,col=size-1;0<col;col-=2){if(6===col)col--;while(!0){for(var c=0;2>c;c++){if(!matrix.isReserved(row,col-c)){var dark=!1;if(byteIndex<data.length){dark=1===(1&data[byteIndex]>>>bitIndex)}matrix.set(row,col-c,dark);bitIndex--;if(-1===bitIndex){byteIndex++;bitIndex=7}}}row+=inc;if(0>row||size<=row){row-=inc;inc=-inc;break}}}}function createData(version,errorCorrectionLevel,segments){var buffer=new BitBuffer;segments.forEach(function(data){buffer.put(data.mode.bit,4);buffer.put(data.getLength(),Mode.getCharCountIndicator(data.mode,version));data.write(buffer)});var totalCodewords=Utils.getSymbolTotalCodewords(version),ecTotalCodewords=ECCode.getTotalCodewordsCount(version,errorCorrectionLevel),dataTotalCodewordsBits=8*(totalCodewords-ecTotalCodewords);if(buffer.getLengthInBits()+4<=dataTotalCodewordsBits){buffer.put(0,4)}while(0!==buffer.getLengthInBits()%8){buffer.putBit(0)}for(var remainingByte=(dataTotalCodewordsBits-buffer.getLengthInBits())/8,i=0;i<remainingByte;i++){buffer.put(i%2?17:236,8)}return createCodewords(buffer,version,errorCorrectionLevel)}function createCodewords(bitBuffer,version,errorCorrectionLevel){for(var totalCodewords=Utils.getSymbolTotalCodewords(version),ecTotalCodewords=ECCode.getTotalCodewordsCount(version,errorCorrectionLevel),ecTotalBlocks=ECCode.getBlocksCount(version,errorCorrectionLevel),totalCodewordsInGroup1=_Mathfloor3(totalCodewords/ecTotalBlocks),dataCodewordsInGroup1=_Mathfloor3((totalCodewords-ecTotalCodewords)/ecTotalBlocks),ecCount=totalCodewordsInGroup1-dataCodewordsInGroup1,rs=new ReedSolomonEncoder(ecCount),offset=0,dcData=Array(ecTotalBlocks),ecData=Array(ecTotalBlocks),maxDataSize=0,buffer=new Buffer(bitBuffer.buffer),b=0,dataSize;b<ecTotalBlocks;b++){dataSize=b<ecTotalBlocks-totalCodewords%ecTotalBlocks?dataCodewordsInGroup1:dataCodewordsInGroup1+1;dcData[b]=buffer.slice(offset,offset+dataSize);ecData[b]=rs.encode(dcData[b]);offset+=dataSize;maxDataSize=Math.max(maxDataSize,dataSize)}var data=new Buffer(totalCodewords),index=0,i,r;for(i=0;i<maxDataSize;i++){for(r=0;r<ecTotalBlocks;r++){if(i<dcData[r].length){data[index++]=dcData[r][i]}}}for(i=0;i<ecCount;i++){for(r=0;r<ecTotalBlocks;r++){data[index++]=ecData[r][i]}}return data}function createSymbol(data,version,errorCorrectionLevel,maskPattern){var segments;if(isArray(data)){segments=Segments.fromArray(data)}else if("string"===typeof data){var estimatedVersion=version;if(!estimatedVersion){var rawSegments=Segments.rawSplit(data);estimatedVersion=Version.getBestVersionForData(rawSegments,errorCorrectionLevel)}segments=Segments.fromString(data,estimatedVersion||40)}else{throw new Error("Invalid data")}var bestVersion=Version.getBestVersionForData(segments,errorCorrectionLevel);if(!bestVersion){throw new Error("The amount of data is too big to be stored in a QR Code")}if(!version){version=bestVersion}else if(version<bestVersion){throw new Error("\n"+"The chosen QR Code version cannot contain this amount of data.\n"+"Minimum version required to store current data is: "+bestVersion+".\n")}var dataBits=createData(version,errorCorrectionLevel,segments),moduleCount=Utils.getSymbolSize(version),modules=new BitMatrix(moduleCount);setupFinderPattern(modules,version);setupTimingPattern(modules);setupAlignmentPattern(modules,version);setupFormatInfo(modules,errorCorrectionLevel,0);if(7<=version){setupVersionInfo(modules,version)}setupData(modules,dataBits);if(!maskPattern){maskPattern=MaskPattern.getBestMask(modules,setupFormatInfo.bind(null,modules,errorCorrectionLevel))}MaskPattern.applyMask(maskPattern,modules);setupFormatInfo(modules,errorCorrectionLevel,maskPattern);return{modules:modules,version:version,errorCorrectionLevel:errorCorrectionLevel,maskPattern:maskPattern,segments:segments}}exports.create=function(data,options){if("undefined"===typeof data||""===data){throw new Error("No input text")}var errorCorrectionLevel=ECLevel.M,version,mask;if("undefined"!==typeof options){errorCorrectionLevel=ECLevel.from(options.errorCorrectionLevel,ECLevel.M);version=Version.from(options.version);mask=MaskPattern.from(options.maskPattern);if(options.toSJISFunc){Utils.setToSJISFunction(options.toSJISFunc)}}return createSymbol(data,version,errorCorrectionLevel,mask)}},{"../utils/buffer":37,"./alignment-pattern":13,"./bit-buffer":15,"./bit-matrix":16,"./error-correction-code":18,"./error-correction-level":19,"./finder-pattern":20,"./format-info":21,"./mask-pattern":24,"./mode":25,"./reed-solomon-encoder":29,"./segments":31,"./utils":32,"./version":33,isarray:11}],29:[function(require,module){var Buffer=require("../utils/buffer"),Polynomial=require("./polynomial");function ReedSolomonEncoder(degree){this.genPoly=void 0;this.degree=degree;if(this.degree)this.initialize(this.degree)}ReedSolomonEncoder.prototype.initialize=function(degree){this.degree=degree;this.genPoly=Polynomial.generateECPolynomial(this.degree)};ReedSolomonEncoder.prototype.encode=function(data){if(!this.genPoly){throw new Error("Encoder not initialized")}var pad=new Buffer(this.degree);pad.fill(0);var paddedData=Buffer.concat([data,pad],data.length+this.degree),remainder=Polynomial.mod(paddedData,this.genPoly),start=this.degree-remainder.length;if(0<start){var buff=new Buffer(this.degree);buff.fill(0);remainder.copy(buff,start);return buff}return remainder};module.exports=ReedSolomonEncoder},{"../utils/buffer":37,"./polynomial":27}],30:[function(require,module,exports){var kanji="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|"+"[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|"+"[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|"+"[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";kanji=kanji.replace(/u/g,"\\u");var byte="(?:(?![A-Z0-9 $%*+\\-./:]|"+kanji+").)+";exports.KANJI=new RegExp(kanji,"g");exports.BYTE_KANJI=/[^A-Z0-9 $%*+\-.\/:]+/g;exports.BYTE=new RegExp(byte,"g");exports.NUMERIC=/[0-9]+/g;exports.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");var TEST_KANJI=new RegExp("^"+kanji+"$"),TEST_NUMERIC=/^[0-9]+$/,TEST_ALPHANUMERIC=/^[A-Z0-9 $%*+\-.\/:]+$/;exports.testKanji=function(str){return TEST_KANJI.test(str)};exports.testNumeric=function(str){return TEST_NUMERIC.test(str)};exports.testAlphanumeric=function(str){return TEST_ALPHANUMERIC.test(str)}},{}],31:[function(require,module,exports){var Mode=require("./mode"),NumericData=require("./numeric-data"),AlphanumericData=require("./alphanumeric-data"),ByteData=require("./byte-data"),KanjiData=require("./kanji-data"),Regex=require("./regex"),Utils=require("./utils"),dijkstra=require("dijkstrajs");function getStringByteLength(str){return unescape(encodeURIComponent(str)).length}function getSegments(regex,mode,str){var segments=[],result;while(null!==(result=regex.exec(str))){segments.push({data:result[0],index:result.index,mode:mode,length:result[0].length})}return segments}function getSegmentsFromString(dataStr){var numSegs=getSegments(Regex.NUMERIC,Mode.NUMERIC,dataStr),alphaNumSegs=getSegments(Regex.ALPHANUMERIC,Mode.ALPHANUMERIC,dataStr),byteSegs,kanjiSegs;if(Utils.isKanjiModeEnabled()){byteSegs=getSegments(Regex.BYTE,Mode.BYTE,dataStr);kanjiSegs=getSegments(Regex.KANJI,Mode.KANJI,dataStr)}else{byteSegs=getSegments(Regex.BYTE_KANJI,Mode.BYTE,dataStr);kanjiSegs=[]}var segs=numSegs.concat(alphaNumSegs,byteSegs,kanjiSegs);return segs.sort(function(s1,s2){return s1.index-s2.index}).map(function(obj){return{data:obj.data,mode:obj.mode,length:obj.length}})}function getSegmentBitsLength(length,mode){switch(mode){case Mode.NUMERIC:return NumericData.getBitsLength(length);case Mode.ALPHANUMERIC:return AlphanumericData.getBitsLength(length);case Mode.KANJI:return KanjiData.getBitsLength(length);case Mode.BYTE:return ByteData.getBitsLength(length);}}function mergeSegments(segs){return segs.reduce(function(acc,curr){var prevSeg=0<=acc.length-1?acc[acc.length-1]:null;if(prevSeg&&prevSeg.mode===curr.mode){acc[acc.length-1].data+=curr.data;return acc}acc.push(curr);return acc},[])}function buildNodes(segs){for(var nodes=[],i=0,seg;i<segs.length;i++){seg=segs[i];switch(seg.mode){case Mode.NUMERIC:nodes.push([seg,{data:seg.data,mode:Mode.ALPHANUMERIC,length:seg.length},{data:seg.data,mode:Mode.BYTE,length:seg.length}]);break;case Mode.ALPHANUMERIC:nodes.push([seg,{data:seg.data,mode:Mode.BYTE,length:seg.length}]);break;case Mode.KANJI:nodes.push([seg,{data:seg.data,mode:Mode.BYTE,length:getStringByteLength(seg.data)}]);break;case Mode.BYTE:nodes.push([{data:seg.data,mode:Mode.BYTE,length:getStringByteLength(seg.data)}]);}}return nodes}function buildGraph(nodes,version){for(var table={},graph={start:{}},prevNodeIds=["start"],i=0;i<nodes.length;i++){for(var nodeGroup=nodes[i],currentNodeIds=[],j=0;j<nodeGroup.length;j++){var node=nodeGroup[j],key=""+i+j;currentNodeIds.push(key);table[key]={node:node,lastCount:0};graph[key]={};for(var n=0,prevNodeId;n<prevNodeIds.length;n++){prevNodeId=prevNodeIds[n];if(table[prevNodeId]&&table[prevNodeId].node.mode===node.mode){graph[prevNodeId][key]=getSegmentBitsLength(table[prevNodeId].lastCount+node.length,node.mode)-getSegmentBitsLength(table[prevNodeId].lastCount,node.mode);table[prevNodeId].lastCount+=node.length}else{if(table[prevNodeId])table[prevNodeId].lastCount=node.length;graph[prevNodeId][key]=getSegmentBitsLength(node.length,node.mode)+4+Mode.getCharCountIndicator(node.mode,version)}}}prevNodeIds=currentNodeIds}for(n=0;n<prevNodeIds.length;n++){graph[prevNodeIds[n]].end=0}return{map:graph,table:table}}function buildSingleSegment(data,modesHint){var mode,bestMode=Mode.getBestModeForData(data);mode=Mode.from(modesHint,bestMode);if(mode!==Mode.BYTE&&mode.bit<bestMode.bit){throw new Error("\""+data+"\""+" cannot be encoded with mode "+Mode.toString(mode)+".\n Suggested mode is: "+Mode.toString(bestMode))}if(mode===Mode.KANJI&&!Utils.isKanjiModeEnabled()){mode=Mode.BYTE}switch(mode){case Mode.NUMERIC:return new NumericData(data);case Mode.ALPHANUMERIC:return new AlphanumericData(data);case Mode.KANJI:return new KanjiData(data);case Mode.BYTE:return new ByteData(data);}}exports.fromArray=function(array){return array.reduce(function(acc,seg){if("string"===typeof seg){acc.push(buildSingleSegment(seg,null))}else if(seg.data){acc.push(buildSingleSegment(seg.data,seg.mode))}return acc},[])};exports.fromString=function(data,version){for(var segs=getSegmentsFromString(data,Utils.isKanjiModeEnabled()),nodes=buildNodes(segs),graph=buildGraph(nodes,version),path=dijkstra.find_path(graph.map,"start","end"),optimizedSegs=[],i=1;i<path.length-1;i++){optimizedSegs.push(graph.table[path[i]].node)}return exports.fromArray(mergeSegments(optimizedSegs))};exports.rawSplit=function(data){return exports.fromArray(getSegmentsFromString(data,Utils.isKanjiModeEnabled()))}},{"./alphanumeric-data":14,"./byte-data":17,"./kanji-data":23,"./mode":25,"./numeric-data":26,"./regex":30,"./utils":32,dijkstrajs:9}],32:[function(require,module,exports){var toSJISFunction,CODEWORDS_COUNT=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];exports.getSymbolSize=function(version){if(!version)throw new Error("\"version\" cannot be null or undefined");if(1>version||40<version)throw new Error("\"version\" should be in range from 1 to 40");return 4*version+17};exports.getSymbolTotalCodewords=function(version){return CODEWORDS_COUNT[version]};exports.getBCHDigit=function(data){var digit=0;while(0!==data){digit++;data>>>=1}return digit};exports.setToSJISFunction=function(f){if("function"!==typeof f){throw new Error("\"toSJISFunc\" is not a valid function.")}toSJISFunction=f};exports.isKanjiModeEnabled=function(){return"undefined"!==typeof toSJISFunction};exports.toSJIS=function(kanji){return toSJISFunction(kanji)}},{}],33:[function(require,module,exports){var _Mathfloor4=Math.floor,Utils=require("./utils"),ECCode=require("./error-correction-code"),ECLevel=require("./error-correction-level"),Mode=require("./mode"),isArray=require("isarray"),G18=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0,G18_BCH=Utils.getBCHDigit(G18);function getBestVersionForDataLength(mode,length,errorCorrectionLevel){for(var currentVersion=1;40>=currentVersion;currentVersion++){if(length<=exports.getCapacity(currentVersion,errorCorrectionLevel,mode)){return currentVersion}}}function getReservedBitsCount(mode,version){return Mode.getCharCountIndicator(mode,version)+4}function getTotalBitsFromDataArray(segments,version){var totalBits=0;segments.forEach(function(data){var reservedBits=getReservedBitsCount(data.mode,version);totalBits+=reservedBits+data.getBitsLength()});return totalBits}function getBestVersionForMixedData(segments,errorCorrectionLevel){for(var currentVersion=1,length;40>=currentVersion;currentVersion++){length=getTotalBitsFromDataArray(segments,currentVersion);if(length<=exports.getCapacity(currentVersion,errorCorrectionLevel,Mode.MIXED)){return currentVersion}}}exports.isValid=function(version){return!isNaN(version)&&1<=version&&40>=version};exports.from=function(value,defaultValue){if(exports.isValid(value)){return parseInt(value,10)}return defaultValue};exports.getCapacity=function(version,errorCorrectionLevel,mode){if(!exports.isValid(version)){throw new Error("Invalid QR Code version")}if("undefined"===typeof mode)mode=Mode.BYTE;var totalCodewords=Utils.getSymbolTotalCodewords(version),ecTotalCodewords=ECCode.getTotalCodewordsCount(version,errorCorrectionLevel),dataTotalCodewordsBits=8*(totalCodewords-ecTotalCodewords);if(mode===Mode.MIXED)return dataTotalCodewordsBits;var usableBits=dataTotalCodewordsBits-getReservedBitsCount(mode,version);switch(mode){case Mode.NUMERIC:return _Mathfloor4(3*(usableBits/10));case Mode.ALPHANUMERIC:return _Mathfloor4(2*(usableBits/11));case Mode.KANJI:return _Mathfloor4(usableBits/13);case Mode.BYTE:default:return _Mathfloor4(usableBits/8);}};exports.getBestVersionForData=function(data,errorCorrectionLevel){var seg,ecl=ECLevel.from(errorCorrectionLevel,ECLevel.M);if(isArray(data)){if(1<data.length){return getBestVersionForMixedData(data,ecl)}if(0===data.length){return 1}seg=data[0]}else{seg=data}return getBestVersionForDataLength(seg.mode,seg.getLength(),ecl)};exports.getEncodedBits=function(version){if(!exports.isValid(version)||7>version){throw new Error("Invalid QR Code version")}var d=version<<12;while(0<=Utils.getBCHDigit(d)-G18_BCH){d^=G18<<Utils.getBCHDigit(d)-G18_BCH}return version<<12|d}},{"./error-correction-code":18,"./error-correction-level":19,"./mode":25,"./utils":32,isarray:11}],34:[function(require,module,exports){var Utils=require("./utils");function clearCanvas(ctx,canvas,size){ctx.clearRect(0,0,canvas.width,canvas.height);if(!canvas.style)canvas.style={};canvas.height=size;canvas.width=size;canvas.style.height=size+"px";canvas.style.width=size+"px"}function getCanvasElement(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}exports.render=function(qrData,canvas,options){var opts=options,canvasEl=canvas;if("undefined"===typeof opts&&(!canvas||!canvas.getContext)){opts=canvas;canvas=void 0}if(!canvas){canvasEl=getCanvasElement()}opts=Utils.getOptions(opts);var size=Utils.getImageWidth(qrData.modules.size,opts),ctx=canvasEl.getContext("2d"),image=ctx.createImageData(size,size);Utils.qrToImageData(image.data,qrData,opts);clearCanvas(ctx,canvasEl,size);ctx.putImageData(image,0,0);return canvasEl};exports.renderToDataURL=function(qrData,canvas,options){var opts=options;if("undefined"===typeof opts&&(!canvas||!canvas.getContext)){opts=canvas;canvas=void 0}if(!opts)opts={};var canvasEl=exports.render(qrData,canvas,opts),type=opts.type||"image/png",rendererOpts=opts.rendererOpts||{};return canvasEl.toDataURL(type,rendererOpts.quality)}},{"./utils":36}],35:[function(require,module,exports){var _Mathfloor5=Math.floor,Utils=require("./utils");function getColorAttrib(color,attrib){var alpha=color.a/255,str=attrib+"=\""+color.hex+"\"";return 1>alpha?str+" "+attrib+"-opacity=\""+alpha.toFixed(2).slice(1)+"\"":str}function svgCmd(cmd,x,y){var str=cmd+x;if("undefined"!==typeof y)str+=" "+y;return str}function qrToPath(data,size,margin){for(var path="",moveBy=0,newRow=!1,lineLength=0,i=0;i<data.length;i++){var col=_Mathfloor5(i%size),row=_Mathfloor5(i/size);if(!col&&!newRow)newRow=!0;if(data[i]){lineLength++;if(!(0<i&&0<col&&data[i-1])){path+=newRow?svgCmd("M",col+margin,.5+row+margin):svgCmd("m",moveBy,0);moveBy=0;newRow=!1}if(!(col+1<size&&data[i+1])){path+=svgCmd("h",lineLength);lineLength=0}}else{moveBy++}}return path}exports.render=function(qrData,options,cb){var opts=Utils.getOptions(options),size=qrData.modules.size,data=qrData.modules.data,qrcodesize=size+2*opts.margin,bg=!opts.color.light.a?"":"<path "+getColorAttrib(opts.color.light,"fill")+" d=\"M0 0h"+qrcodesize+"v"+qrcodesize+"H0z\"/>",path="<path "+getColorAttrib(opts.color.dark,"stroke")+" d=\""+qrToPath(data,size,opts.margin)+"\"/>",width=!opts.width?"":"width=\""+opts.width+"\" height=\""+opts.width+"\" ",svgTag="<svg xmlns=\"http://www.w3.org/2000/svg\" "+width+("viewBox=\""+"0 0 "+qrcodesize+" "+qrcodesize+"\"")+">"+bg+path+"</svg>";if("function"===typeof cb){cb(null,svgTag)}return svgTag}},{"./utils":36}],36:[function(require,module,exports){var _Mathfloor6=Math.floor;function hex2rgba(hex){if("string"!==typeof hex){throw new Error("Color should be defined as hex string")}var hexCode=hex.slice().replace("#","").split("");if(3>hexCode.length||5===hexCode.length||8<hexCode.length){throw new Error("Invalid hex color: "+hex)}if(3===hexCode.length||4===hexCode.length){hexCode=Array.prototype.concat.apply([],hexCode.map(function(c){return[c,c]}))}if(6===hexCode.length)hexCode.push("F","F");var hexValue=parseInt(hexCode.join(""),16);return{r:255&hexValue>>24,g:255&hexValue>>16,b:255&hexValue>>8,a:255&hexValue,hex:"#"+hexCode.slice(0,6).join("")}}exports.getOptions=function(options){if(!options)options={};if(!options.color)options.color={};var margin="undefined"===typeof options.margin||null===options.margin||0>options.margin?4:options.margin,width=options.width&&21<=options.width?options.width:void 0,scale=options.scale||4;return{width:width,scale:width?4:scale,margin:margin,color:{dark:hex2rgba(options.color.dark||"#000000ff"),light:hex2rgba(options.color.light||"#ffffffff")},type:options.type,rendererOpts:options.rendererOpts||{}}};exports.getScale=function(qrSize,opts){return opts.width&&opts.width>=qrSize+2*opts.margin?opts.width/(qrSize+2*opts.margin):opts.scale};exports.getImageWidth=function(qrSize,opts){var scale=exports.getScale(qrSize,opts);return _Mathfloor6((qrSize+2*opts.margin)*scale)};exports.qrToImageData=function(imgData,qr,opts){for(var size=qr.modules.size,data=qr.modules.data,scale=exports.getScale(size,opts),symbolSize=_Mathfloor6((size+2*opts.margin)*scale),scaledMargin=opts.margin*scale,palette=[opts.color.light,opts.color.dark],i=0;i<symbolSize;i++){for(var j=0;j<symbolSize;j++){var posDst=4*(i*symbolSize+j),pxColor=opts.color.light;if(i>=scaledMargin&&j>=scaledMargin&&i<symbolSize-scaledMargin&&j<symbolSize-scaledMargin){var iSrc=_Mathfloor6((i-scaledMargin)/scale),jSrc=_Mathfloor6((j-scaledMargin)/scale);pxColor=palette[data[iSrc*size+jSrc]?1:0]}imgData[posDst++]=pxColor.r;imgData[posDst++]=pxColor.g;imgData[posDst++]=pxColor.b;imgData[posDst]=pxColor.a}}}},{}],37:[function(require,module){"use strict";var isArray=require("isarray");Buffer.TYPED_ARRAY_SUPPORT=function(){try{var arr=new Uint8Array(1);arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return 42===arr.foo()}catch(e){return!1}}();var K_MAX_LENGTH=Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function Buffer(arg,offset,length){if(!Buffer.TYPED_ARRAY_SUPPORT&&!(this instanceof Buffer)){return new Buffer(arg,offset,length)}if("number"===typeof arg){return allocUnsafe(this,arg)}return from(this,arg,offset,length)}if(Buffer.TYPED_ARRAY_SUPPORT){Buffer.prototype.__proto__=Uint8Array.prototype;Buffer.__proto__=Uint8Array;if("undefined"!==typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer){Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1})}}function checked(length){if(length>=K_MAX_LENGTH){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+K_MAX_LENGTH.toString(16)+" bytes")}return 0|length}function isnan(val){return val!==val}function createBuffer(that,length){var buf;if(Buffer.TYPED_ARRAY_SUPPORT){buf=new Uint8Array(length);buf.__proto__=Buffer.prototype}else{buf=that;if(null===buf){buf=new Buffer(length)}buf.length=length}return buf}function allocUnsafe(that,size){var buf=createBuffer(that,0>size?0:0|checked(size));if(!Buffer.TYPED_ARRAY_SUPPORT){for(var i=0;i<size;++i){buf[i]=0}}return buf}function fromString(that,string){var length=0|byteLength(string),buf=createBuffer(that,length),actual=buf.write(string);if(actual!==length){buf=buf.slice(0,actual)}return buf}function fromArrayLike(that,array){for(var length=0>array.length?0:0|checked(array.length),buf=createBuffer(that,length),i=0;i<length;i+=1){buf[i]=255&array[i]}return buf}function fromArrayBuffer(that,array,byteOffset,length){if(0>byteOffset||array.byteLength<byteOffset){throw new RangeError("'offset' is out of bounds")}if(array.byteLength<byteOffset+(length||0)){throw new RangeError("'length' is out of bounds")}var buf;if(byteOffset===void 0&&length===void 0){buf=new Uint8Array(array)}else if(length===void 0){buf=new Uint8Array(array,byteOffset)}else{buf=new Uint8Array(array,byteOffset,length)}if(Buffer.TYPED_ARRAY_SUPPORT){buf.__proto__=Buffer.prototype}else{buf=fromArrayLike(that,buf)}return buf}function fromObject(that,obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length),buf=createBuffer(that,len);if(0===buf.length){return buf}obj.copy(buf,0,0,len);return buf}if(obj){if("undefined"!==typeof ArrayBuffer&&obj.buffer instanceof ArrayBuffer||"length"in obj){if("number"!==typeof obj.length||isnan(obj.length)){return createBuffer(that,0)}return fromArrayLike(that,obj)}if("Buffer"===obj.type&&Array.isArray(obj.data)){return fromArrayLike(that,obj.data)}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){codePoint=string.charCodeAt(i);if(55295<codePoint&&57344>codePoint){if(!leadSurrogate){if(56319<codePoint){if(-1<(units-=3))bytes.push(239,191,189);continue}else if(i+1===length){if(-1<(units-=3))bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(56320>codePoint){if(-1<(units-=3))bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else if(leadSurrogate){if(-1<(units-=3))bytes.push(239,191,189)}leadSurrogate=null;if(128>codePoint){if(0>(units-=1))break;bytes.push(codePoint)}else if(2048>codePoint){if(0>(units-=2))break;bytes.push(192|codePoint>>6,128|63&codePoint)}else if(65536>codePoint){if(0>(units-=3))break;bytes.push(224|codePoint>>12,128|63&codePoint>>6,128|63&codePoint)}else if(1114112>codePoint){if(0>(units-=4))break;bytes.push(240|codePoint>>18,128|63&codePoint>>12,128|63&codePoint>>6,128|63&codePoint)}else{throw new Error("Invalid code point")}}return bytes}function byteLength(string){if(Buffer.isBuffer(string)){return string.length}if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(string)||string instanceof ArrayBuffer)){return string.byteLength}if("string"!==typeof string){string=""+string}var len=string.length;if(0===len)return 0;return utf8ToBytes(string).length}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;++i){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function from(that,value,offset,length){if("number"===typeof value){throw new TypeError("\"value\" argument must not be a number")}if("undefined"!==typeof ArrayBuffer&&value instanceof ArrayBuffer){return fromArrayBuffer(that,value,offset,length)}if("string"===typeof value){return fromString(that,value,offset)}return fromObject(that,value)}Buffer.prototype.write=function(string,offset,length){if(offset===void 0){length=this.length;offset=0}else if(length===void 0&&"string"===typeof offset){length=this.length;offset=0}else if(isFinite(offset)){offset=0|offset;if(isFinite(length)){length=0|length}else{length=void 0}}var remaining=this.length-offset;if(length===void 0||length>remaining)length=remaining;if(0<string.length&&(0>length||0>offset)||offset>this.length){throw new RangeError("Attempt to write outside buffer bounds")}return utf8Write(this,string,offset,length)};Buffer.prototype.slice=function(start,end){var len=this.length;start=~~start;end=end===void 0?len:~~end;if(0>start){start+=len;if(0>start)start=0}else if(start>len){start=len}if(0>end){end+=len;if(0>end)end=0}else if(end>len){end=len}if(end<start)end=start;var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT){newBuf=this.subarray(start,end);newBuf.__proto__=Buffer.prototype}else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,void 0);for(var i=0;i<sliceLen;++i){newBuf[i]=this[i+start]}}return newBuf};Buffer.prototype.copy=function(target,targetStart,start,end){if(!start)start=0;if(!end&&0!==end)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(0<end&&end<start)end=start;if(end===start)return 0;if(0===target.length||0===this.length)return 0;if(0>targetStart){throw new RangeError("targetStart out of bounds")}if(0>start||start>=this.length)throw new RangeError("sourceStart out of bounds");if(0>end)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start}var len=end-start,i;if(this===target&&start<targetStart&&targetStart<end){for(i=len-1;0<=i;--i){target[i+targetStart]=this[i+start]}}else if(1e3>len||!Buffer.TYPED_ARRAY_SUPPORT){for(i=0;i<len;++i){target[i+targetStart]=this[i+start]}}else{Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart)}return len};Buffer.prototype.fill=function(val,start,end){if("string"===typeof val){if("string"===typeof start){start=0;end=this.length}else if("string"===typeof end){end=this.length}if(1===val.length){var code=val.charCodeAt(0);if(256>code){val=code}}}else if("number"===typeof val){val=255&val}if(0>start||this.length<start||this.length<end){throw new RangeError("Out of range index")}if(end<=start){return this}start=start>>>0;end=end===void 0?this.length:end>>>0;if(!val)val=0;var i;if("number"===typeof val){for(i=start;i<end;++i){this[i]=val}}else{var bytes=Buffer.isBuffer(val)?val:new Buffer(val),len=bytes.length;for(i=0;i<end-start;++i){this[i+start]=bytes[i%len]}}return this};Buffer.concat=function(list,length){if(!isArray(list)){throw new TypeError("\"list\" argument must be an Array of Buffers")}if(0===list.length){return createBuffer(null,0)}var i;if(length===void 0){length=0;for(i=0;i<list.length;++i){length+=list[i].length}}var buffer=allocUnsafe(null,length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf)){throw new TypeError("\"list\" argument must be an Array of Buffers")}buf.copy(buffer,pos);pos+=buf.length}return buffer};Buffer.byteLength=byteLength;Buffer.prototype._isBuffer=!0;Buffer.isBuffer=function(b){return!!(null!=b&&b._isBuffer)};module.exports=Buffer},{isarray:11}],38:[function(require,module){(function(global){"use strict";module.exports="object"===typeof self&&self.self===self&&self||"object"===typeof global&&global.global===global&&global||this}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],nebpay:[function(require,module){"use strict";var extend=require("extend"),http=require("./libs/http"),config=require("./libs/config"),Pay=require("./libs/pay"),BigNumber=require("bignumber.js"),NAS="NAS",NebPay=function(appKey,appSecret){this._pay=new Pay(appKey,appSecret)};NebPay.config=config;var defaultOptions={goods:{name:"",desc:"",orderId:"",ext:""},qrcode:{showQRCode:!1,container:void 0},callback:config.mainnetUrl,listener:void 0,nrc20:void 0};NebPay.prototype={pay:function(to,value,options){options=extend(defaultOptions,options);return this._pay.submit(NAS,to,value,{type:"binary"},options)},nrc20pay:function(currency,to,value,options){if(options.nrc20&&0<options.nrc20.decimals){value=value||"0";value=new BigNumber(value).times(new BigNumber(10).pow(options.nrc20.decimals)).toString(10)}var address="";if(options.nrc20&&options.nrc20.address){address=options.nrc20.address}var args=[to,value],payload={type:"call",function:"transfer",args:JSON.stringify(args)};options=extend(defaultOptions,options);return this._pay.submit(currency,address,"0",payload,options)},deploy:function(source,sourceType,args,options){options=extend(defaultOptions,options);return this._pay.submit(NAS,"","0",{type:"deploy",source:source,sourceType:sourceType,args:args},options)},call:function(to,value,func,args,options){options=extend(defaultOptions,options);return this._pay.submit(NAS,to,value,{type:"call",function:func,args:args},options)},simulateCall:function(to,value,func,args,options){options=extend(defaultOptions,options);return this._pay.submit(NAS,to,value,{type:"simulateCall",function:func,args:args},options)},queryPayInfo:function(serialNumber,options){options=extend(defaultOptions,options);var url=options.callback+"/query?payId="+serialNumber;return http.get(url)}};module.exports=NebPay},{"./libs/config":2,"./libs/http":4,"./libs/pay":5,"bignumber.js":7,extend:10}]},{},[]);